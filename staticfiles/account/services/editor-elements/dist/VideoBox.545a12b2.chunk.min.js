(("undefined"!=typeof self?self:this).webpackJsonp_thunderbolt_elements=("undefined"!=typeof self?self:this).webpackJsonp_thunderbolt_elements||[]).push([[397],{517:function(e,t,n){"use strict";n.r(t);var r=n(4),a=n(179),o=n(714),u=n(934);t.default=a.forwardRef((function(e,t){var n=a.createElement(o.a,Object(r.__assign)({id:e.id},e.meshProps),e.children);return a.createElement(u.a,Object(r.__assign)({},e,{compRef:t,mediaControls:n}))}))},934:function(e,t,n){"use strict";var r=n(4),a=n(179),o=n(659),u=n.n(o),i=n(711),s=n(660),d=n(765),c=n(813),l=n.n(c),v=n(663);var f=n(812),p=n(784);f.Kampos.prototype.play=function(){var e=this;if(!this.animationFrameId){var t=function(){e.animationFrameId=window.requestAnimationFrame(t);var n=e.media;n&&n.readyState>=n.HAVE_CURRENT_DATA&&(!n.paused&&!n.ended||e._needsRedraw)&&(e._needsRedraw=!1,e.draw())};this.animationFrameId=window.requestAnimationFrame(t)}};function m(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16)/255,parseInt(t[2],16)/255,parseInt(t[3],16)/255,1]:e}var h=function(e){void 0===e&&(e={});var t=[f.effects.transparentVideo()],n="brightness"in e,r="contrast"in e;if(n||r){var a=f.effects.brightnessContrast();n&&(a.brightness=e.brightness),r&&(a.contrast=e.contrast),t.push(a)}if(e.duotoneDark&&e.duotoneLight){var o=f.effects.duotone();o.dark=m(e.duotoneDark),o.light=m(e.duotoneLight),t.push(o)}var u="hue"in e,i="saturation"in e;if(u||i){var s=f.effects.hueSaturation();u&&(s.hue=e.hue),i&&(s.saturation=e.saturation),t.push(s)}return t},w=function(e){return e.readyState>=e.HAVE_CURRENT_DATA},y={count:0,set:new Set,add:function(e){return!!y.set.has(e)||!f.Kampos.preventContextCreation&&y.set.size<14&&(y.set.add(e),y.count=y.set.size,!0)},remove:function(e){y.set.delete(e),y.count=y.set.size}};var g=!Object(s.c)(),b=Object(s.b)()&&p.b(window);t.a=function(e){var t,n,o=e.id,c=e.translate,p=e.mediaControls,m=e.containerRootClassName,R=e.compRef,E=e.fillLayers,C=e.reducedMotion,A=void 0!==C&&C,I=e.isMobileView,P=e.audioEnabled,k=e.hasAudio,M=e.hasClick,_=e.hasRollIn,x=e.hasAudioRollIn,T=e.canClickPause,V=e.canRollPause,L=e.muted,S=e.autoplay,K=e.canReplay,O=e.hasMask,j=e.animatePoster,D=e.filterEffect,H=e.isTransparent,N=void 0!==H&&H,F=e.alt,U=e.updateState,q=e.onPlay,z=e.onPause,B=e.onEnded,J=e.onProgress,$=e.getPlaceholder,W=a.useRef(null),G=a.useRef(null),Q=a.useRef(null),X=a.useRef(null),Y=a.useRef(null),Z=a.useRef(null),ee=a.createRef(),te=S&&!A,ne=a.useCallback((function(e){var t,n;if(U){var r="on"!==(null===(t=W.current)||void 0===t?void 0:t.dataset.audio),a=+((null===(n=W.current)||void 0===n?void 0:n.dataset.volume)||1),o=e||{paused:!0,currentTime:0,duration:0,volume:a,muted:r};U({isPlaying:!o.paused,currentTime:o.currentTime||0,duration:o.duration||0,volume:100*a,isMuted:r,shouldPlay:S}),e&&(e.volume=a)}}),[S,U]),re=a.useState(!N||!b),ae=re[0],oe=re[1],ue=a.useState(O),ie=ue[0],se=ue[1],de=a.useState(!!N&&!ae),ce=de[0],le=de[1],ve=!(!O||!g),fe=a.useMemo((function(){return ae&&!ce}),[ae,ce]),pe=a.useMemo((function(){return N&&ae?function(e){var t=e.filterEffect,n=e.playerRef,r=e.videoRef,a=e.canvasRef,o=e.contextRef,u=e.kampos,i=e.setCanPlayTV,s=!1,d=!1;function c(){r.current&&n.current&&(r.current.removeEventListener("seeked",c),n.current.dataset.showCanvas="",d=!0)}var l={initKampos:function(){var e=this;try{u.current=new f.Kampos({target:a.current,effects:h(t||{}),onContextLost:function(){var t=u.current._source&&u.current._source.media;t&&(t.ended||t.paused)&&(u.current._needsRedraw=!0),e.stopKampos(),s&&e.playKampos()}})}catch(e){i(!1)}if(r.current){var n=function(){var e;r.current&&(u.current.setSource({width:(e=r.current)&&e.videoWidth||0,height:e&&e.videoHeight/2||0,media:e}),l.playKampos(),r.current.removeEventListener("loadeddata",n,!1))};w(r.current)?n():r.current.addEventListener("loadeddata",n,!1)}},playKampos:function(){n.current&&a.current&&(u.current&&u.current.hasContext||y.add(o)?(u.current&&u.current.gl?(u.current.lostContext&&u.current.restoreContext(),u.current.play(),!d&&u.current.media&&w(u.current.media)&&"playing"in n.current.dataset&&l.removePoster()):l.initKampos(),u.current.hasContext=!0):d&&l.showPoster())},stopKampos:function(){y.remove(o),u.current.hasContext=!1,u.current.stop()},killKampos:function(){var e;u.current&&(l.stopKampos(),u.current.destroy()),null===(e=r.current)||void 0===e||e.removeEventListener("seeked",c)},removePoster:function(){var e=r.current,t=n.current;!d&&t&&e&&u.current&&((e.paused||e.ended||u.current._needsRedraw)&&(u.current._needsRedraw=!1,u.current.draw()),e.addEventListener("seeked",c),e.currentTime=0)},showPoster:function(){n.current&&r.current&&(delete n.current.dataset.showCanvas,d=!1)},onViewEnter:function(){s=!0,l.playKampos()},onViewLeave:function(){s=!1,u.current&&u.current.hasContext&&l.stopKampos()}};return l}({filterEffect:D,playerRef:W,videoRef:G,canvasRef:Q,contextRef:ee,kampos:Z,setCanPlayTV:oe}):null}),[D,ee,N,ae,E]),me=a.useMemo((function(){var e={play:[],pause:[],ended:[],timeupdate:[]};if(U){var t=function(e){return U({isPlaying:!e.target.paused,duration:e.target.duration})};e.loadeddata=[function(e){ne(e.target)}],e.play.push(t),e.pause.push(t),e.ended.push(t),e.timeupdate.push((function(e){return U({currentTime:e.target.currentTime})}))}return N&&pe&&e.play.push(pe.removePoster),q&&e.play.push((function(){return q({type:"onPlay"})})),z&&e.pause.push((function(){return z({type:"onPause"})})),B&&e.ended.push((function(){return B({type:"onEnded"})})),J&&e.timeupdate.push((function(){return J({type:"onProgress"})})),e}),[q,z,B,J,N,ne,pe,U]),he=P&&k,we=a.useMemo((function(){return function(e){var t,n,a=e.playerRef,o=e.videoRef,u=e.playButtonRef,i=e.audioRef,d=e.isMobileView,c=e.autoplay,l=e.hasAudio,f=e.hasClick,p=e.hasRollIn,m=e.hasAudioRollIn,h=e.canClickPause,w=e.canRollPause,y=e.canReplay,g=e.extraMediaHandlers,b=void 0===g?{}:g,R=e.updateState,E=void 0===R?function(){}:R,C=+((null===(t=a.current)||void 0===t?void 0:t.dataset.volume)||1);function A(e){if(a.current&&o.current){var t="boolean"==typeof e?e:!o.current.muted;x=!t,t?M.mute():M.unmute()}}var I,P,k,M={setVolume:function(e){C=e,o.current&&(o.current.volume=C),a.current&&(a.current.dataset.volume=C.toString())},play:function(e){a.current&&o.current&&(e&&(a.current.dataset.playing="",E({shouldPlay:!0})),u.current&&u.current.setAttribute("aria-pressed","true"),o.current.play(),T=!0)},pause:function(){a.current&&o.current&&(delete a.current.dataset.playing,u.current&&u.current.setAttribute("aria-pressed","false"),o.current.pause(),E({shouldPlay:!1}))},stop:function(){a.current&&o.current&&(delete a.current.dataset.playing,u.current&&u.current.setAttribute("aria-pressed","false"),o.current.pause(),o.current.currentTime=0,E({shouldPlay:!1}))},togglePlay:function(){o.current&&(o.current.paused?M.play(!0):M.pause())},mute:function(){a.current&&o.current&&(o.current.muted=!0,a.current.dataset.audio="off",i.current&&i.current.setAttribute("aria-pressed","true"),E({isMuted:!0}))},unmute:function(e){if(a.current&&o.current){var t=a.current,r=o.current,u=function(){e?K(r):r.muted=!1,t.dataset.audio="on",i.current&&i.current.setAttribute("aria-pressed","false"),E({isMuted:!1})};if(n&&"running"!==n.state){var s=n.resume();s&&s.then(u)}else u()}}},_=!1,x=l,T=c||!f,V={handleEvent:function(e){var t=e.type,n=a.current;"loadeddata"===t&&n&&(n.dataset.canPlay=""),"ended"===t&&n&&(y||(_=!0,n.dataset.stop=""),delete n.dataset.playing),b[t]&&b[t].length&&b[t].forEach((function(t){return t(e)}))}},L=function(e){e.dataset.showAudio="",clearTimeout(P),P=window.setTimeout((function(){delete e.dataset.showAudio}),2e3)},S=function(e){clearTimeout(P),delete e.dataset.showAudio},K=function(e){e.volume=0,e.muted=!1;var t=0;window.clearInterval(I),I=window.setInterval((function(){(t+=.2)>=C?(e.volume=C,window.clearInterval(I)):e.volume=t}),200)},O=function(e){e.volume=C;var t=1;window.clearInterval(I),I=window.setInterval((function(){(t-=.2)<=0?(e.volume=0,e.muted=!0,window.clearInterval(I)):e.volume=t}),200)},j=Object(s.b)()&&"ontouchend"in window&&d,D=d?void 0:function(e){if(Object(r.__spreadArrays)(v.g.space,v.g.enter).includes(e.key)){e.preventDefault();var t=a.current,n=o.current,u=i.current;t&&n&&!_&&(u&&u.contains(e.target)?A():M.togglePlay())}},H=j||!l&&!f?void 0:function(e){n&&n.resume();var t=a.current,r=o.current,u=i.current;t&&r&&!_&&(l&&u&&(L(t),u.contains(e.target))?A():r.paused?M.play(!0):h&&M.pause())},N=!j&&(l||p||f)?function(){var e=a.current,t=o.current;e&&t&&!_&&(p?M.play():f&&(e.dataset.rollIn=""),l&&T&&(L(e),x&&(m||p)&&t.muted&&M.unmute(!0)))}:void 0,F=j&&(l||f||p)?function(e){var t=a.current,n=o.current,r=i.current;if(t&&n&&!_){var u=!c&&!t.dataset.touched,s="on"===t.dataset.touched;l&&(L(t),r&&r.contains(e.target))?A():((u||s)&&(n.paused?M.play(!0):(h||w)&&M.pause()),(f||p)&&(clearTimeout(k),t.dataset.touched="on",k=window.setTimeout((function(){return t.dataset.touched="off"}),1400)))}}:void 0;return{videoAPI:M,onClick:H,onMouseEnter:N,onMouseLeave:!j&&(l||w||f)?function(){var e=a.current,t=o.current;e&&t&&(w?t.pause():f&&delete e.dataset.rollIn,l&&(S(e),m&&!t.muted&&(n?O(t):t.muted=!0)))}:void 0,onMouseMove:!j&&l?function(){var e=a.current;e&&l&&T&&L(e)}:void 0,onTouchEnd:F,onKeyDown:D,mediaHandler:V,setAudioContext:function(){var e=window.AudioContext||window.webkitAudioContext;Object(s.b)()&&e&&o.current&&(n=new e)},MEDIA_EVENTS:new Set(Object(r.__spreadArrays)(Object.keys(b),["loadeddata","ended"]))}}({playerRef:W,videoRef:G,playButtonRef:X,audioRef:Y,isMobileView:I,autoplay:te,hasAudio:he,hasClick:M,hasRollIn:_,hasAudioRollIn:x,canClickPause:T,canRollPause:V,canReplay:K,extraMediaHandlers:me,updateState:U})}),[W,G,G.current,me,U,he]),ye=we.videoAPI,ge=we.onClick,be=we.onMouseEnter,Re=we.onMouseLeave,Ee=we.onMouseMove,Ce=we.onTouchEnd,Ae=we.onKeyDown,Ie=we.mediaHandler,Pe=we.setAudioContext,ke=we.MEDIA_EVENTS;return Object(d.a)((function(){var e,t;if(fe&&W.current&&(Y.current||(Y.current=W.current.querySelector("[data-audio-mute]"))),le(ve),!(null===(t=null===(e=null==E?void 0:E.video)||void 0===e?void 0:e.videoInfo)||void 0===t?void 0:t.isVideoDataExists)&&W.current&&delete W.current.dataset.showCanvas,!(ve||N&&!ae)&&(N||he||M)){var n=function(e){var t=e.playerRef,n=e.videoRef,r=e.onViewEnter,a=e.onViewLeave;if(Object(s.b)()){var o={visible:!window.document.hidden,intersecting:!1},u=function(){n.current&&t.current&&"playing"in t.current.dataset&&(o.visible=!window.document.hidden,o.visible&&o.intersecting?n.current.play():n.current.pause())};window.document.addEventListener("visibilitychange",u);var i=null;return t.current&&"function"==typeof window.IntersectionObserver&&(i=new window.IntersectionObserver((function(e){var u=t.current,i=n.current;i&&u&&e.forEach((function(e){i&&e.target===u&&(o.intersecting=e.isIntersecting,o.visible&&o.intersecting?(null==r||r(),"playing"in u.dataset&&i.src&&i.play()):(null==a||a(),i.pause()))}))}))).observe(t.current),function(){window.document.removeEventListener("visibilitychange",u),i&&(i.disconnect(),i=null)}}}({playerRef:W,videoRef:G,onViewEnter:null==pe?void 0:pe.onViewEnter,onViewLeave:null==pe?void 0:pe.onViewLeave});return function(){null==n||n(),null==pe||pe.killKampos()}}}),[N,W,G,G.current,Q,ae,pe,he]),a.useEffect((function(){if(!N||ae){var e=G.current,t=new Set(Array.from(ke).concat(Object.keys(me).filter((function(e){return me[e]&&me[e].length}))));return t.forEach((function(t){e&&!ve&&("loadeddata"===t&&e.readyState>=e.HAVE_CURRENT_DATA?(Ie.handleEvent({type:t}),ne(G.current)):e.addEventListener(t,Ie))})),Pe&&!ve&&Pe(),function(){t.forEach((function(t){e&&e.removeEventListener(t,Ie)}))}}}),[N,ae,G,G.current,Pe,Ie,ke,ve,me,U,ne]),Object(d.a)((function(){var e=W.current;if(ve&&E.video&&e){var t=function(e){var t=e.match(/.*svg\+xml,(.*)"\)$/);return t&&t[1]?window.decodeURIComponent(t[1]):""}(window.getComputedStyle(e).getPropertyValue("--mask-image"));E.video.posterImageInfo.maskDataElementString=function(e){var t=e.svgContent,n=e.compId,r=e.alt,a=t.match(/(:?<\?xml[^?]*\?>)?(<svg[^>]*>)/);if(!a)return"";var o=a[1]?t.replace(a[1],""):t,u=window.document.createElement("div");u.innerHTML=o;var i=u.firstElementChild;if(!i)return"";var s="svg-content-"+n;i.setAttribute("id",s);var d=s+"-filter",c=s+"-mask";return'<svg ref="svg'+n+'" id="svg'+n+'" version="1.1" preserveAspectRatio="none" width="100%" height="100%" role="img" aria-label="'+r+'">\n      <defs>\n        <filter id="'+d+'">\n          <feColorMatrix\n            type="matrix"\n            values="0 0 0 0 1\n                    0 0 0 0 1\n                    0 0 0 0 1\n                    0 0 0 1 0"\n          />\n        </filter>\n        <mask id="'+c+'">\n          <use\n            filter="url(#'+d+')"\n            xlink:href="#'+s+'"\n            width="100%"\n            height="100%"\n            x="0"\n            y="0"\n          />\n        </mask>\n        '+u.innerHTML+'\n      </defs>\n      <image id="'+n+'image" ref="image"  mask="url(#'+c+')" width="100%" height="100%"/>\n    </svg>'}({svgContent:t,compId:o,alt:E.video.posterImageInfo.alt||""}),E.video.isVideoEnabled=!1,se(!1)}}),[W,o,E.video,ve]),a.useImperativeHandle(R,(function(){return ye})),a.createElement("div",{id:o,ref:W,className:u()(l.a.videobox,m,(t={},t[l.a.masked]=ie,t)),onClick:fe?ge:void 0,onMouseEnter:fe?be:void 0,onMouseLeave:fe?Re:void 0,onMouseMove:fe?Ee:void 0,onTouchEnd:fe?Ce:void 0,onKeyDown:fe?Ae:void 0,"data-audio":L?"off":"on","data-has-play":fe&&(M||_)?"":void 0,"data-no-audio":fe&&he?void 0:"","data-playing":fe&&te?"":void 0,"data-stop":fe?void 0:"","data-animate-poster":N?j:void 0,"data-has-alpha":N?"true":void 0},a.createElement("div",{ref:X,className:u()(l.a.videoboxContainer,(n={},n[l.a.hasCanvas]=N,n)),tabIndex:0,role:"button","aria-label":F+" "+c("ariaLabels","VideoBox_AriaLabel_Play_Video","Play video"),"aria-pressed":te?"true":"false"},a.createElement(i.a,Object(r.__assign)({},E,{getPlaceholder:$,reducedMotion:A,videoRef:G,canvasRef:N?Q:void 0,extraClass:l.a.videoboxFill}))),fe?p:null)}}}]);
//# sourceMappingURL=https://static.parastorage.com/services/editor-elements/dist/VideoBox.545a12b2.chunk.min.js.map